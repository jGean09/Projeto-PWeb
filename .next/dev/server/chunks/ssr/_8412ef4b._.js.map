{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ivyso/Documents/proj_animes/Projeto-PWeb/proj_anime/app/actions/anime.ts"],"sourcesContent":["\"use server\";\r\n\r\n// Cache simples para rate limiting\r\nconst requestQueue: Array<() => Promise<void>> = [];\r\nlet isProcessing = false;\r\n\r\nasync function processQueue() {\r\n  if (isProcessing || requestQueue.length === 0) return;\r\n  \r\n  isProcessing = true;\r\n  await requestQueue.shift()!();\r\n  isProcessing = false;\r\n  \r\n  // Delay entre requests (1.5 segundos para segurança)\r\n  await new Promise(resolve => setTimeout(resolve, 1500));\r\n  processQueue();\r\n}\r\n\r\n// Server Action para busca de animes\r\nexport async function searchAnimeAction(query: string, page: number = 1) {\r\n  return new Promise<any>((resolve, reject) => {\r\n    requestQueue.push(async () => {\r\n      try {\r\n        console.log(`[SERVER] Buscando: \"${query}\" - Página ${page}`);\r\n        \r\n        const url = query.trim()\r\n          ? `https://api.jikan.moe/v4/anime?q=${encodeURIComponent(query)}&page=${page}&limit=24`\r\n          : `https://api.jikan.moe/v4/seasons/now?page=${page}&limit=24`;\r\n        \r\n        const response = await fetch(url, {\r\n          headers: { 'Accept': 'application/json' }\r\n        });\r\n        \r\n        if (!response.ok) {\r\n          if (response.status === 429) {\r\n            console.warn('[SERVER] Rate limit atingido, aguardando...');\r\n            await new Promise(resolve => setTimeout(resolve, 3000));\r\n            // Tenta mais uma vez\r\n            const retryResponse = await fetch(url);\r\n            if (!retryResponse.ok) {\r\n              throw new Error(`API error: ${retryResponse.status}`);\r\n            }\r\n            const retryData = await retryResponse.json();\r\n            resolve(retryData);\r\n            return;\r\n          }\r\n          throw new Error(`API error: ${response.status}`);\r\n        }\r\n        \r\n        const data = await response.json();\r\n        console.log(`[SERVER] ${data.data?.length || 0} resultados para \"${query}\"`);\r\n        resolve(data);\r\n      } catch (error) {\r\n        console.error('[SERVER] Erro na busca:', error);\r\n        reject(error);\r\n      }\r\n    });\r\n    \r\n    processQueue();\r\n  });\r\n}\r\n\r\n// Server Action para trending animes\r\nexport async function getTrendingAnimesAction(limit: number = 6) {\r\n  return new Promise<any>((resolve, reject) => {\r\n    requestQueue.push(async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `https://api.jikan.moe/v4/top/anime?limit=${limit}`\r\n        );\r\n        \r\n        if (!response.ok) throw new Error(`API error: ${response.status}`);\r\n        \r\n        const data = await response.json();\r\n        resolve(data);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n    \r\n    processQueue();\r\n  });\r\n}\r\n\r\n// Server Action para detalhes do anime\r\nexport async function getAnimeDetailsAction(id: string) {\r\n  return new Promise<any>((resolve, reject) => {\r\n    requestQueue.push(async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `https://api.jikan.moe/v4/anime/${id}`\r\n        );\r\n        \r\n        if (!response.ok) throw new Error(`API error: ${response.status}`);\r\n        \r\n        const data = await response.json();\r\n        resolve(data);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n    \r\n    processQueue();\r\n  });\r\n}"],"names":[],"mappings":";;;;;;;;;;;AAEA,mCAAmC;AACnC,MAAM,eAA2C,EAAE;AACnD,IAAI,eAAe;AAEnB,eAAe;IACb,IAAI,gBAAgB,aAAa,MAAM,KAAK,GAAG;IAE/C,eAAe;IACf,MAAM,aAAa,KAAK;IACxB,eAAe;IAEf,qDAAqD;IACrD,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;IACjD;AACF;AAGO,eAAe,kBAAkB,KAAa,EAAE,OAAe,CAAC;IACrE,OAAO,IAAI,QAAa,CAAC,SAAS;QAChC,aAAa,IAAI,CAAC;YAChB,IAAI;gBACF,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,MAAM,WAAW,EAAE,MAAM;gBAE5D,MAAM,MAAM,MAAM,IAAI,KAClB,CAAC,iCAAiC,EAAE,mBAAmB,OAAO,MAAM,EAAE,KAAK,SAAS,CAAC,GACrF,CAAC,0CAA0C,EAAE,KAAK,SAAS,CAAC;gBAEhE,MAAM,WAAW,MAAM,MAAM,KAAK;oBAChC,SAAS;wBAAE,UAAU;oBAAmB;gBAC1C;gBAEA,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,IAAI,SAAS,MAAM,KAAK,KAAK;wBAC3B,QAAQ,IAAI,CAAC;wBACb,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;wBACjD,qBAAqB;wBACrB,MAAM,gBAAgB,MAAM,MAAM;wBAClC,IAAI,CAAC,cAAc,EAAE,EAAE;4BACrB,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,cAAc,MAAM,EAAE;wBACtD;wBACA,MAAM,YAAY,MAAM,cAAc,IAAI;wBAC1C,QAAQ;wBACR;oBACF;oBACA,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,SAAS,MAAM,EAAE;gBACjD;gBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,KAAK,IAAI,EAAE,UAAU,EAAE,kBAAkB,EAAE,MAAM,CAAC,CAAC;gBAC3E,QAAQ;YACV,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,OAAO;YACT;QACF;QAEA;IACF;AACF;AAGO,eAAe,wBAAwB,QAAgB,CAAC;IAC7D,OAAO,IAAI,QAAa,CAAC,SAAS;QAChC,aAAa,IAAI,CAAC;YAChB,IAAI;gBACF,MAAM,WAAW,MAAM,MACrB,CAAC,yCAAyC,EAAE,OAAO;gBAGrD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,SAAS,MAAM,EAAE;gBAEjE,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,QAAQ;YACV,EAAE,OAAO,OAAO;gBACd,OAAO;YACT;QACF;QAEA;IACF;AACF;AAGO,eAAe,sBAAsB,EAAU;IACpD,OAAO,IAAI,QAAa,CAAC,SAAS;QAChC,aAAa,IAAI,CAAC;YAChB,IAAI;gBACF,MAAM,WAAW,MAAM,MACrB,CAAC,+BAA+B,EAAE,IAAI;gBAGxC,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,SAAS,MAAM,EAAE;gBAEjE,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,QAAQ;YACV,EAAE,OAAO,OAAO;gBACd,OAAO;YACT;QACF;QAEA;IACF;AACF;;;IArFsB;IA4CA;IAsBA;;AAlEA,+OAAA;AA4CA,+OAAA;AAsBA,+OAAA"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ivyso/Documents/proj_animes/Projeto-PWeb/proj_anime/.next-internal/server/app/search/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {searchAnimeAction as '60dd55a9786c773af334114db0467ef29f90e65cfd'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ivyso/Documents/proj_animes/Projeto-PWeb/proj_anime/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ivyso/Documents/proj_animes/Projeto-PWeb/proj_anime/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}